!function e(t,a,r){function i(s,n){if(!a[s]){if(!t[s]){var l="function"==typeof require&&require;if(!n&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=a[s]={exports:{}};t[s][0].call(d.exports,function(e){var a=t[s][1][e];return i(a||e)},d,d.exports,e,t,a,r)}return a[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,a){var r=wp.media.controller.Library.extend({defaults:_.defaults({id:"image-crate",title:imagecrate.page_title,multiple:!1,menu:"default",router:"image-crate",toolbar:"image-crate-toolbar",searchable:!0,filterable:!1,sortable:!1,autoSelect:!0,describe:!1,contentUserSetting:!0,syncSelection:!1,priority:800,isImageCrate:!0},wp.media.controller.Library.prototype.defaults),initialize:function(){this.get("library")||this.set("library",wp.media.query({imagecrate:!0})),wp.media.controller.Library.prototype.initialize.apply(this,arguments)}});t.exports=r},{}],2:[function(e,t,a){var r=e("./controllers/image-crate-controller.js"),i=e("./views/browser/image-crate-photo.js"),o=e("./models/image-crate-photo-model.js"),s=e("./views/browser/image-crate-photos.js"),n=wp.media.view.MediaFrame.Post.prototype.createStates,l=wp.media.view.MediaFrame.Select.prototype.bindHandlers;_.extend(wp.media.view.MediaFrame.prototype,{image_crate:{activate:function(){var e=_.first(this.views.get(".media-frame-router")),t={};t.usatoday={text:"USA Today Images",priority:60},e.set(t),this.content.mode("usatoday")},createToolbar:function(){var e=this;this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:"Download Image",priority:80,requires:{selection:!0},click:function(){var t=e.state(),a=t.get("selection");this.$el.attr("disabled","disabled").text("Downloading"),wp.media.ajax({data:{action:"image_crate_download",filename:a.models[0].get("filename"),id:a.models[0].get("id"),download_uri:a.models[0].get("download_uri"),_ajax_nonce:imagecrate.nonce}}).done(function(t){e.setState("insert");var a=wp.media.frame.content.mode("browse");a.get("gallery").collection.add(t),a.get("selection").collection.add(t),a.get("insert").collection.remove(t),a.get("insert").collection.unshift(t),wp.Uploader.queue.add(t),wp.Uploader.queue.remove(t),a.get("insert").$("li:first .thumbnail").click()})}}}}))},loadGetty:function(){var e=this.state(),t=e.get("image_crate_photos"),a=e.get("selection");_.isUndefined(t)&&(t=new o(null,{props:{query:!0}}),e.set("image_crate_photos",t)),this.content.set(new s({className:"image-crate attachments-browser",controller:this,collection:t,selection:a,model:e,filters:!1,date:!1,AttachmentView:i}))}}}),wp.media.view.MediaFrame.Select.prototype.bindHandlers=function(){l.apply(this,arguments),this.on("router:create:image-crate",this.createRouter,this),this.on("router:activate:image-crate",this.image_crate.activate,this),this.on("router:deactivate:image-crate",this.deactivate,this),this.on("toolbar:create:image-crate-toolbar",this.image_crate.createToolbar,this),this.on("content:render:usatoday",this.image_crate.loadGetty,this)},wp.media.view.MediaFrame.Post.prototype.createStates=function(){n.apply(this,arguments),this.states.add(new r)},jQuery(function(e){e(document).on("click",".thumbnail",function(){var t=e("[data-setting=caption]").find("textarea"),a=e("[data-setting=description]").find("textarea");t.val()||(t.val(a.val()),t.change())})})},{"./controllers/image-crate-controller.js":1,"./models/image-crate-photo-model.js":3,"./views/browser/image-crate-photo.js":5,"./views/browser/image-crate-photos.js":6}],3:[function(e,t,a){var r=e("./image-crate-photos-query"),i=wp.media.model.Attachments.extend({initialize:function(e,t){wp.media.model.Attachments.prototype.initialize.call(this,e,t)},_requery:function(e){var t;this.props.get("query")&&(t=this.props.toJSON(),t.cache=!0!==e,this.mirror(r.get(t)))}});t.exports=i},{"./image-crate-photos-query":4}],4:[function(e,t,a){var r=wp.media.model.Query.extend({sync:function(e,t,a){var r;return"read"===e?(a=a||{},a.context=this,a.data=_.extend(a.data||{},{action:"image_crate_get",_ajax_nonce:imagecrate.nonce}),r=_.clone(this.args),console.log("the args yo"),console.dir(r),console.log("the model yo"),console.dir(t),console.log("the options yo"),console.dir(a),-1!==r.posts_per_page&&(r.paged=Math.round(this.length/r.posts_per_page)+1),a.data.query=r,wp.media.ajax(a)):(fallback=Attachments.prototype.sync?Attachments.prototype:Backbone,fallback.sync.apply(this,arguments))}},{get:function(){var e=[];return function(t,a){var i,o=r,s={},n=!!t.cache||_.isUndefined(t.cache);return delete t.query,delete t.cache,_.each(t,function(e,t){_.isNull(e)||(s[t]=e)}),_.defaults(s,o.defaultArgs),n?i=_.find(e,function(e){return _.isEqual(e.args,s)}):e=[],i||(i=new o([],_.extend(a||{},{props:t,args:s})),console.log("was no query here it at"),console.log(i),e.push(i)),console.log("final return here it at"),console.log(i),i}}()});t.exports=r},{}],5:[function(e,t,a){var r=wp.media.view.Attachment.extend({render:function(){var e=_.defaults(this.model.toJSON(),{orientation:"landscape",uploading:!1,type:"",subtype:"",icon:"",filename:"",caption:"",title:"",dateFormatted:"",width:"",height:"",compat:!1,alt:"",description:""},this.options);return e.buttons=this.buttons,e.describe=this.controller.state().get("describe"),"image"===e.type&&(e.size=this.imageSize("thumbnail")),e.can={},e.nonces&&(e.can.remove=!!e.nonces.delete,e.can.save=!!e.nonces.update),this.controller.state().get("allowLocalEdits")&&(e.allowLocalEdits=!0),e.uploading&&!e.percent&&(e.percent=0),this.views.detach(),console.log("pasing templ the opts..."),console.log(e),this.$el.html(this.template(e)),this.$el.toggleClass("uploading",e.uploading),e.uploading?this.$bar=this.$(".media-progress-bar div"):delete this.$bar,this.updateSelect(),this.updateSave(),this.views.render(),this}});t.exports=r},{}],6:[function(e,t,a){var r,i=e("./search.js"),o=e("./no-results.js"),s=e("./type-filter.js"),n=e("./sort-filters.js"),l=wp.media.view.AttachmentsBrowser.prototype.initialize;r=wp.media.view.AttachmentsBrowser.extend({tagName:"div",className:"image-crate attachments-browser",defaults:_.defaults({filters:!1,search:!1,date:!1,display:!1,sidebar:!0},wp.media.view.AttachmentsBrowser.prototype.defaults),initialize:function(){l.apply(this,arguments),this.createToolBar(),this.createUploader()},createToolBar:function(){this.toolbar.set("TypeFilterLabel",new wp.media.view.Label({value:"Type Filter Label",attributes:{for:"media-attachment-type-filter"},priority:-75}).render()),this.toolbar.set("TypeFilter",new s({controller:this.controller,model:this.collection.props,priority:-75}).render()),this.toolbar.set("SortFilterLabel",new wp.media.view.Label({value:"Sort By",attributes:{for:"media-attachment-sort-filters"},priority:-50}).render()),this.toolbar.set("SortFilter",new n({controller:this.controller,model:this.collection.props,priority:-50}).render()),this.toolbar.set("search",new i({controller:this.controller,model:this.collection.props,priority:60}).render())},createUploader:function(){this.uploader=new o({controller:this.controller,status:!1,message:"Sorry, No images were found."}),this.uploader.hide(),this.views.add(this.uploader)}}),t.exports=r},{"./no-results.js":7,"./search.js":8,"./sort-filters.js":9,"./type-filter.js":10}],7:[function(e,t,a){var r,i=wp.media.view.UploaderInline;r=i.extend({tagName:"div",className:"image-crate-no-results uploader-inline",template:wp.template("image-crate-no-results"),ready:function(){var e,t=this.options.$browser;if(this.controller.uploader){if(e=this.$(".browser"),e[0]===t[0])return;t.detach().text(e.text()),t[0].className="browser button button-hero",e.replaceWith(t.show())}return this.refresh(),this}}),t.exports=r},{}],8:[function(e,t,a){var r=wp.media.View.extend({tagName:"input",className:"search ic-search",id:"media-search-input",attributes:{type:"search",placeholder:"Search Getty Images"},events:{input:"search",keyup:"search"},initialize:function(){void 0===this.model.get("search")&&this.model.set("search",imagecrate.default_search)},render:function(){return this.el.value=void 0===this.model.get("search")?imagecrate.default_search:this.model.escape("search"),this},search:function(e){this.deBounceSearch(e)},deBounceSearch:_.debounce(function(e){e.target.value?this.model.set("search",e.target.value):this.model.unset("search")},400)});t.exports=r},{}],9:[function(e,t,a){var r=wp.media.view.AttachmentFilters.extend({id:"media-attachment-sort-filters",createFilters:function(){var e={},t=[{sort:"most_popular",text:"Most Popular"},{sort:"newest",text:"Newest"}];_.each(t||{},function(t,a){e[a]={text:t.text,props:{sort:t.sort}}}),e.all={text:"Best Match",props:{vertical:"best_match"},priority:10},this.filters=e}});t.exports=r},{}],10:[function(e,t,a){var r=wp.media.view.AttachmentFilters.extend({id:"media-attachment-type-filter",createFilters:function(){var e={},t=[{type:"adv",text:"Advanced"}];_.each(t||{},function(t,a){e[a]={text:t.text,props:{type:t.type}}}),e.all={text:"Simple",props:{type:"simple"},priority:10},this.filters=e}});t.exports=r},{}]},{},[2]);